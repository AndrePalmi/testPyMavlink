<!DOCTYPE html>
<html lang="en">
<head>
<title>Page Title</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body {
  font-family: Arial, Helvetica, sans-serif;
}
</style>
</head>
<body>

  <p>
    <button onclick="showCode()">Show JavaScript</button>
    <button onclick="runCode()">Run JavaScript</button>
    <button onclick="runCodePython()">Run Python</button>
  </p>

<script src="blockly_compressed.js"></script>
<script src="javascript_compressed.js"></script>
<script src="python_compressed.js"></script>
<script src="blocks_compressed.js"></script>
<!--
<script src="blocks/block.js"></script>
<script src="generators/javascript/block.js"></script>

<script src="blocks/ins_numero.js"></script>
<script src="generators/javascript/ins_numero.js"></script>

<script src="blocks/stampa_numero.js"></script>
<script src="generators/javascript/stampa_numero.js"></script>
<script src="generators/python/stampa_numero.js"></script>
-->

<script src="blocks/take_off.js"></script>
<script src="generators/python/take_off.js"></script>

<script src="blocks/arm_motors.js"></script>
<script src="generators/python/arm_motors.js"></script>

<script src="blocks/disarm_motors.js"></script>
<script src="generators/python/disarm_motors.js"></script>
<script src="generators/javascript/disarm_motors.js"></script>

<script src="blocks/rtl.js"></script>
<script src="generators/python/rtl.js"></script>


<script src="blocks/land.js"></script>
<script src="generators/python/land.js"></script>

<xml id="toolbox" style="display: none">
<!--
  <block type="inserisci_numero"></block>
  <block type="stampa_numero"></block>
  <block type="string_length"></block>
-->
  <block type="takeoff"></block>
  <block type="arm_motors"></block>
  <block type="disarm_motors"></block>
  <block type="rtl"></block>
  <block type="land"></block>
  <block type="text"></block>
  <block type="text_print"></block>
  <block type="math_number"></block>

  <block type="controls_if"></block>
  <block type="controls_repeat_ext"></block>
  <block type="logic_compare"></block>
  <block type="math_arithmetic"></block>


</xml>

<div>
    <div id="blocklyDiv" style="height: 920px; width: 800px;">
    </div>
</div>

<script src="msg/js/en.js"></script>

<script>
  var workspace = Blockly.inject('blocklyDiv',
    {toolbox: document.getElementById('toolbox'),
     grid:
         {spacing: 20,
          length: 3,
          colour: '#ccc',
          snap: true},
     trashcan: true});

</script>

  <script>

    function showCode() {
      // Generate JavaScript code and display it.
      Blockly.JavaScript.INFINITE_LOOP_TRAP = null;
      var code = Blockly.JavaScript.workspaceToCode(workspace);
      alert(code);
    }

    function runCode() {
      // Generate JavaScript code and run it.
      window.LoopTrap = 1000;
      Blockly.JavaScript.INFINITE_LOOP_TRAP =
          'if (--window.LoopTrap == 0) throw "Infinite loop.";\n';

      Blockly.JavaScript.addReservedWords('code');
      var code = Blockly.JavaScript.workspaceToCode(workspace);

      Blockly.JavaScript.INFINITE_LOOP_TRAP = null;

      try {
        eval(code);
      } catch (e) {
        alert(e);
      }
    }

    function runCodePython() {
      // Generate JavaScript code and run it.
      window.LoopTrap = 1000;
      Blockly.Python.INFINITE_LOOP_TRAP =
          'if (--window.LoopTrap == 0) throw "Infinite loop.";\n';


      Blockly.Python.addReservedWords('code');
      var code = Blockly.Python.workspaceToCode(workspace);

      // non sappiamo come eseguire il python salvato nella var code...
    }
  </script>

<pre id="output" ></pre> 
</body>
</html> 
